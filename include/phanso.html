<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ti·ªác Pizza Ph√¢n S·ªë</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Nunito:wght@600;700;800&display=swap');
        
        body {
            font-family: 'Nunito', sans-serif;
            background-color: #fff7ed; /* Cam nh·∫°t */
            user-select: none;
            touch-action: manipulation;
        }

        .game-card {
            background: white;
            border-radius: 1.5rem;
            box-shadow: 0 10px 0 #fb923c;
            border: 4px solid #fdba74;
        }

        /* SVG Pizza Styles */
        .pizza-slice {
            fill: #facc15; /* M√†u ph√¥ mai */
            stroke: #b45309; /* M√†u v·ªè b√°nh */
            stroke-width: 3px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .pizza-slice:hover {
            filter: brightness(1.1);
        }

        /* Hi·ªáu ·ª©ng khi mi·∫øng b√°nh b·ªã ƒÉn */
        .slice-eaten {
            opacity: 0.1; /* M·ªù ƒëi */
            transform: scale(0.9);
            fill: #cbd5e1;
            stroke: #94a3b8;
        }

        /* Pepperoni (X√∫c x√≠ch) trang tr√≠ */
        .pepperoni {
            fill: #ef4444;
            opacity: 0.8;
            pointer-events: none; /* Kh√¥ng ch·∫∑n click */
        }

        /* CSS hi·ªÉn th·ªã ph√¢n s·ªë to√°n h·ªçc */
        .fraction {
            display: inline-block;
            text-align: center;
            vertical-align: middle;
            font-weight: 800;
            margin: 0 5px;
        }
        .frac-top {
            display: block;
            border-bottom: 3px solid currentColor;
            padding-bottom: 2px;
            line-height: 1;
        }
        .frac-bottom {
            display: block;
            padding-top: 2px;
            line-height: 1;
        }

        .stat-box {
            background: #fff;
            border: 2px solid #fed7aa;
            border-radius: 12px;
            padding: 8px 16px;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 4px 0 #fed7aa;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center justify-center p-3">

    <div class="game-card w-full max-w-xl p-4 md:p-8 text-center">
        
        <h1 class="text-3xl font-extrabold text-orange-600 mb-2">Ti·ªác Pizza Ph√¢n S·ªë üçï</h1>
        <p id="instruction" class="text-slate-500 font-bold mb-6 text-lg">
            B√© h√£y gi√∫p b·∫°n nh·ªè ƒÉn <span class="text-orange-600 text-2xl">...</span> mi·∫øng b√°nh nh√©!
        </p>

        <div class="relative w-64 h-64 mx-auto mb-8 drop-shadow-xl">
            <svg id="pizza-svg" viewBox="-110 -110 220 220" class="w-full h-full overflow-visible">
            </svg>
        </div>

        <div class="flex justify-center gap-4 mb-8">
            <div class="stat-box text-orange-600">
                <span class="text-sm font-bold uppercase">ƒê√£ ƒÉn:</span>
                <div class="fraction text-2xl">
                    <span id="eaten-num" class="frac-top">0</span>
                    <span id="total-denom-1" class="frac-bottom">?</span>
                </div>
            </div>

            <div class="stat-box text-green-600">
                <span class="text-sm font-bold uppercase">C√≤n l·∫°i:</span>
                <div class="fraction text-2xl">
                    <span id="remain-num" class="frac-top">?</span>
                    <span id="total-denom-2" class="frac-bottom">?</span>
                </div>
            </div>
        </div>

        <div class="h-12 flex justify-center items-center">
            <p id="msg" class="text-lg font-bold text-slate-700"></p>
            <button id="nextBtn" onclick="game.newLevel()" class="hidden bg-orange-500 hover:bg-orange-600 text-white font-bold py-2 px-8 rounded-full shadow-lg transform transition hover:-translate-y-1">
                B√°nh Ti·∫øp Theo ‚ûú
            </button>
        </div>
    </div>

<script>
    class PizzaGame {
        constructor() {
            this.svg = document.getElementById('pizza-svg');
            this.eatenNumEl = document.getElementById('eaten-num');
            this.remainNumEl = document.getElementById('remain-num');
            this.denomEl1 = document.getElementById('total-denom-1');
            this.denomEl2 = document.getElementById('total-denom-2');
            this.instructionEl = document.getElementById('instruction');
            this.msg = document.getElementById('msg');
            this.nextBtn = document.getElementById('nextBtn');

            this.totalSlices = 4;
            this.eatenCount = 0;
            this.targetToEat = 1;
            this.isPlaying = true;

            this.newLevel();
        }

        newLevel() {
            // Reset tr·∫°ng th√°i
            this.isPlaying = true;
            this.eatenCount = 0;
            this.msg.textContent = "";
            this.nextBtn.classList.add('hidden');
            this.svg.innerHTML = '';

            // 1. Random s·ªë mi·∫øng (m·∫´u s·ªë) t·ª´ 2 ƒë·∫øn 8
            this.totalSlices = Math.floor(Math.random() * 7) + 2; 
            
            // 2. Random s·ªë mi·∫øng c·∫ßn ƒÉn (t·ª≠ s·ªë) t·ª´ 1 ƒë·∫øn (total - 1)
            // ƒê·ªÉ lu√¥n c√≤n th·ª´a √≠t nh·∫•t 1 mi·∫øng cho c√≥ √Ω nghƒ©a
            this.targetToEat = Math.floor(Math.random() * (this.totalSlices - 1)) + 1;

            // 3. C·∫≠p nh·∫≠t ƒë·ªÅ b√†i
            this.instructionEl.innerHTML = `B√© h√£y b·∫•m ƒë·ªÉ ƒÉn <span class="text-orange-600 font-black text-2xl">${this.targetToEat}</span> mi·∫øng b√°nh nh√©!`;
            
            // 4. C·∫≠p nh·∫≠t hi·ªÉn th·ªã ph√¢n s·ªë ban ƒë·∫ßu
            this.updateStats();

            // 5. V·∫Ω Pizza
            this.drawPizza();
        }

        drawPizza() {
            const radius = 100;
            
            // N·∫øu ch·ªâ c√≥ 1 mi·∫øng (tr∆∞·ªùng h·ª£p hi·∫øm ho·∫∑c logic kh√°c, ·ªü ƒë√¢y min=2 n√™n v·∫Ω sector b√¨nh th∆∞·ªùng)
            // G√≥c c·ªßa m·ªói mi·∫øng
            const angleStep = (Math.PI * 2) / this.totalSlices;

            for (let i = 0; i < this.totalSlices; i++) {
                // T√≠nh to√°n t·ªça ƒë·ªô v·∫Ω h√¨nh qu·∫°t (Pie slice)
                const startAngle = i * angleStep - Math.PI / 2; // -PI/2 ƒë·ªÉ b·∫Øt ƒë·∫ßu t·ª´ 12 gi·ªù
                const endAngle = (i + 1) * angleStep - Math.PI / 2;

                const x1 = Math.cos(startAngle) * radius;
                const y1 = Math.sin(startAngle) * radius;
                const x2 = Math.cos(endAngle) * radius;
                const y2 = Math.sin(endAngle) * radius;

                // L·ªánh v·∫Ω SVG Path: Move to center -> Line to rim -> Arc -> Line back to center
                // Flag largeArc: n·∫øu g√≥c > 180 ƒë·ªô (ch·ªâ x·∫£y ra khi chia 1, ·ªü ƒë√¢y min chia 2 n√™n lu√¥n l√† 0)
                const largeArcFlag = 0; 

                const d = `M 0 0 L ${x1} ${y1} A ${radius} ${radius} 0 ${largeArcFlag} 1 ${x2} ${y2} Z`;

                // T·∫°o Group ch·ª©a Slice v√† Pepperoni
                const g = document.createElementNS("http://www.w3.org/2000/svg", "g");
                g.setAttribute("class", "pizza-slice");
                g.onclick = (e) => this.eatSlice(e.currentTarget);

                // V·∫Ω v·ªè/ph√¥ mai
                const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
                path.setAttribute("d", d);
                g.appendChild(path);

                // V·∫Ω Pepperoni trang tr√≠ (t√≠nh t√¢m c·ªßa slice ƒë·ªÉ ƒë·∫∑t)
                const midAngle = startAngle + angleStep / 2;
                const dist = radius * 0.6; // Kho·∫£ng c√°ch t·ª´ t√¢m
                const pepX = Math.cos(midAngle) * dist;
                const pepY = Math.sin(midAngle) * dist;
                
                const circle = document.createElementNS("http://www.w3.org/2000/svg", "circle");
                circle.setAttribute("cx", pepX);
                circle.setAttribute("cy", pepY);
                circle.setAttribute("r", 6);
                circle.setAttribute("class", "pepperoni");
                g.appendChild(circle);

                this.svg.appendChild(g);
            }
        }

        eatSlice(element) {
            if (!this.isPlaying) return;
            
            // N·∫øu mi·∫øng n√†y ƒë√£ ƒÉn r·ªìi th√¨ th√¥i
            if (element.classList.contains('slice-eaten')) return;

            // ƒÇn mi·∫øng b√°nh
            element.classList.add('slice-eaten');
            this.eatenCount++;
            
            // C·∫≠p nh·∫≠t s·ªë li·ªáu
            this.updateStats();

            // Ki·ªÉm tra k·∫øt qu·∫£
            this.checkWin();
        }

        updateStats() {
            // C·∫≠p nh·∫≠t text ph√¢n s·ªë
            this.eatenNumEl.textContent = this.eatenCount;
            this.remainNumEl.textContent = this.totalSlices - this.eatenCount;
            
            this.denomEl1.textContent = this.totalSlices;
            this.denomEl2.textContent = this.totalSlices;
        }

        checkWin() {
            if (this.eatenCount === this.targetToEat) {
                this.isPlaying = false;
                this.msg.innerHTML = "<span class='text-green-600'>Gi·ªèi qu√°! B√© ƒë√£ chia ƒë√∫ng ph·∫ßn b√°nh r·ªìi! üéâ</span>";
                this.nextBtn.classList.remove('hidden');
            } else if (this.eatenCount > this.targetToEat) {
                this.isPlaying = false;
                this.msg.innerHTML = "<span class='text-red-500'>√îi no qu√°! B√© l·ª° ƒÉn nhi·ªÅu h∆°n y√™u c·∫ßu r·ªìi! üòÖ</span>";
                // Cho n√∫t next hi·ªán ra ƒë·ªÉ ch∆°i l·∫°i
                setTimeout(() => this.nextBtn.classList.remove('hidden'), 1000);
            }
        }
    }

    // Kh·ªüi t·∫°o game
    const game = new PizzaGame();

</script>
</body>
</html>